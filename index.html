<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Cascade Studio</title>
        <meta charset="utf-8">
        <meta name="application-name"   content="Cascade Studio">
        <meta name="description"        content="A Full Live-Scripted CAD Kernel in the Browser">
        <meta name="keywords"           content="SCAD, OpenSCAD, CAD, OpenCascade, Scripting">
        <meta name="author"             content="Johnathon Selstad">
        <meta name="viewport"           content="width=device-width, initial-scale=1.0">
        <meta name="theme-color"        content="#1e1e1e">

        <!-- Service Worker for offline access (must be first) -->
        <script>
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('service-worker.js').then(function(registration) {
                    registration.update();
                }, function() {
                    console.log('Could not register Cascade Studio for offline use!');
                });
            }
        </script>

        <!-- Import map for Three.js bare specifier (required by Three.js ESM submodules) -->
        <script type="importmap">
        {
            "imports": {
                "three": "./node_modules/three/build/three.module.js"
            }
        }
        </script>

        <link rel="shortcut icon"    href="./icon/favicon.ico" type="image/x-icon">
        <link rel="manifest"         href="./manifest.webmanifest">
        <link rel="apple-touch-icon" href="./icon/apple-touch-icon.png">

        <!-- Golden Layout v2 CSS -->
        <link rel="stylesheet" href="./lib/golden-layout/goldenlayout-base.css">
        <link rel="stylesheet" href="./lib/golden-layout/goldenlayout-dark-theme.css">
        <link rel="stylesheet" href="./css/main.css">

        <!-- Monaco Editor CSS + AMD loader (ESM workers too complex for buildless use) -->
        <link data-name="vs/editor/editor.main" rel="stylesheet" href="./node_modules/monaco-editor/min/vs/editor/editor.main.css">
        <script>
            var require = { paths: { 'vs': 'node_modules/monaco-editor/min/vs' } };
            // Configure Monaco worker URLs for v0.52+
            self.MonacoEnvironment = {
                getWorkerUrl: function(moduleId, label) {
                    return './node_modules/monaco-editor/min/vs/base/worker/workerMain.js';
                }
            };
        </script>
        <script src="./node_modules/monaco-editor/min/vs/loader.js"></script>
        <script src="./node_modules/monaco-editor/min/vs/editor/editor.main.js"></script>
    </head>

    <body style="margin:0px; background-color:rgb(34, 34, 34);">
        <h1 hidden></h1>
        <div id="topnav" class="topnav">
            <a href="https://github.com/zalo/CascadeStudio">Cascade Studio</a>
            <a href="#" title="Save Project to .json" onmouseup="window.saveProject();">Save Project</a>
            <a href="#" title="Load Project from .json" onmouseup="window.loadProject();">Load Project</a>
            <a href="#" onmouseup="window.threejsViewport?.saveShapeSTEP();">Save STEP</a>
            <a href="#" onmouseup="window.threejsViewport?.saveShapeSTL();">Save STL</a>
            <a href="#" onmouseup="window.threejsViewport?.saveShapeOBJ();">Save OBJ</a>
            <label for="files" title="Import STEP, IGES, or (ASCII) STL from File">Import STEP/IGES/STL
                <input id="files" name="files" type="file" accept=".iges,.step,.igs,.stp,.stl" multiple style="display:none;" oninput="window.loadFiles();"/>
            </label>
            <a href="#" title="Clears the external step/iges/stl files stored in the project." onmouseup="window.clearExternalFiles();">Clear Imported Files</a>
        </div>
        <div id="appbody" style="height:auto">
            <script type="module" src="./js/MainPage/main.js"></script>
        </div>
    </body>
</html>
